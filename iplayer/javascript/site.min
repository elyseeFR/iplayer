function parseUri(sourceUri){var uriPartNames=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"];var uriParts=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)?((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?").exec(sourceUri);var uri={};for(var i=0;i<10;i++){uri[uriPartNames[i]]=(uriParts[i]?uriParts[i]:"");}if(uri.directoryPath.length>0){uri.directoryPath=uri.directoryPath.replace(/\/?$/,"/");}return uri;}function setQueryVariables(url,name,value){var purl=parseUri(url);var data=getQueryVariables(purl);data[name]=value;var query=[];for(name in data){if(name==""){continue;}query.push(name+"="+encodeURIComponent(data[name]));}return(purl["protocol"]?purl["protocol"]+"://":"")+purl["domain"]+purl["path"]+"?"+query.join("&");}function getQueryVariables(purl){if(!purl["query"]){return{};}var data={};var vars=purl["query"].split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");data[pair[0]]=decodeURIComponent(pair[1]).replace(/\+/g," ");}return data;}